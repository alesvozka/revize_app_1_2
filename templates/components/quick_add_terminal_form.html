<form hx-post="/circuit/{{ circuit_id }}/terminal/quick-add" hx-target="#terminals-section" hx-swap="innerHTML" hx-indicator="#quick-add-terminal-spinner" class="bg-blue-50 border-2 border-blue-200 rounded-lg p-4 animate-fadeIn">
    <div class="flex justify-between items-center mb-3">
        <h4 class="font-medium text-gray-900">Nové koncové zařízení</h4>
        <button type="button" onclick="this.closest('#quick-add-form-container').innerHTML=''" class="text-gray-400 hover:text-gray-600 transition">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
        </button>
    </div>
    <div class="space-y-3">
        <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Název zařízení <span class="text-red-500">*</span></label>
            <input type="text" name="terminal_name" required autofocus class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="např. Světlo chodba">
        </div>
        <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Typ zařízení</label>
            <select name="terminal_type" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                <option value="">-- Vyberte typ --</option>
                {% for source in dropdown_sources.get('terminal_type', []) %}<option value="{{ source.value }}">{{ source.value }}</option>{% endfor %}
            </select>
        </div>
        <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Umístění</label>
            <input type="text" name="terminal_location" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="např. Chodba">
        </div>
    </div>
    <details class="mt-3">
        <summary class="cursor-pointer text-sm text-gray-600 hover:text-gray-900 flex items-center space-x-1 py-2 px-2 hover:bg-white rounded transition">
            <svg class="w-4 h-4 transform transition-transform details-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>
            <span class="font-medium">Více polí...</span>
        </summary>
        <div class="mt-3 space-y-3 pl-4 border-l-2 border-gray-200">
            <div><label class="block text-sm font-medium text-gray-700 mb-1">Popis</label><textarea name="terminal_description" rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="Volitelný popis..."></textarea></div>
            <div><label class="block text-sm font-medium text-gray-700 mb-1">Pořadí</label><input type="number" name="terminal_order" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="Automatické"></div>
            <div><label class="block text-sm font-medium text-gray-700 mb-1">Příkon (W)</label><input type="number" step="0.01" name="terminal_power" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"></div>
            <div><label class="block text-sm font-medium text-gray-700 mb-1">Poznámka</label><textarea name="terminal_note" rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"></textarea></div>
        </div>
    </details>
    <div class="flex items-center space-x-2 mt-4">
        <button type="submit" class="flex-1 bg-primary text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition font-medium">Uložit</button>
        <button type="button" onclick="this.closest('#quick-add-form-container').innerHTML=''" class="px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition">Zrušit</button>
    </div>
    <div id="quick-add-terminal-spinner" class="htmx-indicator mt-3 flex items-center justify-center space-x-2 text-sm text-gray-600">
        <svg class="animate-spin h-5 w-5 text-primary" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" fill="none"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"></path></svg>
        <span>Ukládám...</span>
    </div>
</form>
<style>.animate-fadeIn{animation:fadeIn .2s ease-out}@keyframes fadeIn{from{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.htmx-indicator{display:none}.htmx-request .htmx-indicator{display:flex}details[open] .details-arrow{transform:rotate(90deg)}</style>
