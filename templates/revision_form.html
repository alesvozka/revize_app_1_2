{% extends "base.html" %}

{% block title %}{% if revision %}Editace revize{% else %}Nová revize{% endif %} - Revize App{% endblock %}

{% block sidebar_breadcrumbs %}
{% set breadcrumbs = [
    {'label': 'Dashboard', 'url': '/'},
    {'label': 'Nová revize' if not revision else 'Editace revize', 'url': ''}
] %}
{{ super() }}
{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <div class="mb-4">
        <h2 class="text-2xl font-bold text-gray-800">
            {% if revision %}Editace revize{% else %}Nová revize{% endif %}
        </h2>
        <p class="text-sm text-gray-600 mt-1">
            {% if revision %}Upravte detaily revize{% else %}Vyplňte informace o nové revizi{% endif %}
        </p>
    </div>

    <form method="POST" action="{% if revision %}/revision/{{ revision.revision_id }}/update{% else %}/revision/create{% endif %}" class="flat-card">
        <div class="p-4 space-y-6">
            
            <div>
                <h3 class="text-base font-semibold text-gray-800 mb-3 pb-2 border-b border-gray-200">Základní informace</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="form-label">Kód revize</label>
                        <input type="text" name="revision_code" value="{% if revision %}{{ revision.revision_code or '' }}{% endif %}" class="form-input">
                    </div>
                    <div>
                        <label class="form-label">Název revize <span class="text-red-500">*</span></label>
                        <input type="text" name="revision_name" value="{% if revision %}{{ revision.revision_name or '' }}{% endif %}" required class="form-input">
                    </div>
                    <div>
                        <label class="form-label">Vlastník</label>
                        <input type="text" name="revision_owner" value="{% if revision %}{{ revision.revision_owner or '' }}{% endif %}" class="form-input">
                    </div>
                    <div>
                        <label class="form-label">Klient</label>
                        <input type="text" name="revision_client" value="{% if revision %}{{ revision.revision_client or '' }}{% endif %}" class="form-input">
                    </div>
                    <div class="md:col-span-2">
                        <label class="form-label">Adresa</label>
                        <textarea name="revision_address" rows="2" class="form-input">{% if revision %}{{ revision.revision_address or '' }}{% endif %}</textarea>
                    </div>
                    <div class="md:col-span-2">
                        <label class="form-label">Popis</label>
                        <textarea name="revision_description" rows="2" class="form-input">{% if revision %}{{ revision.revision_description or '' }}{% endif %}</textarea>
                    </div>
                    <div>
                        <label class="form-label">Typ revize</label>
                        <input type="text" name="revision_type" value="{% if revision %}{{ revision.revision_type or '' }}{% endif %}" class="form-input">
                    </div>
                </div>
            </div>

            <div>
                <h3 class="text-base font-semibold text-gray-800 mb-3 pb-2 border-b border-gray-200">Data</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="form-label">Datum vytvoření</label>
                        <input type="date" name="revision_date_of_creation" value="{% if revision and revision.revision_date_of_creation %}{{ revision.revision_date_of_creation.strftime('%Y-%m-%d') }}{% endif %}" class="form-input">
                    </div>
                    <div>
                        <label class="form-label">Datum zahájení</label>
                        <input type="date" name="revision_start_date" value="{% if revision and revision.revision_start_date %}{{ revision.revision_start_date.strftime('%Y-%m-%d') }}{% endif %}" class="form-input">
                    </div>
                    <div>
                        <label class="form-label">Datum ukončení</label>
                        <input type="date" name="revision_end_date" value="{% if revision and revision.revision_end_date %}{{ revision.revision_end_date.strftime('%Y-%m-%d') }}{% endif %}" class="form-input">
                    </div>
                    <div>
                        <label class="form-label">Datum předchozí revize</label>
                        <input type="date" name="revision_date_of_previous_revision" value="{% if revision and revision.revision_date_of_previous_revision %}{{ revision.revision_date_of_previous_revision.strftime('%Y-%m-%d') }}{% endif %}" class="form-input">
                    </div>
                    <div>
                        <label class="form-label">Doporučené datum příští revize</label>
                        <input type="date" name="revision_recommended_date_for_next_revision" value="{% if revision and revision.revision_recommended_date_for_next_revision %}{{ revision.revision_recommended_date_for_next_revision.strftime('%Y-%m-%d') }}{% endif %}" class="form-input">
                    </div>
                </div>
            </div>

            <div>
                <h3 class="text-base font-semibold text-gray-800 mb-3 pb-2 border-b border-gray-200">Osoby</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="form-label">Technik</label>
                        <input type="text" name="revision_technician" value="{% if revision %}{{ revision.revision_technician or '' }}{% endif %}" class="form-input">
                    </div>
                    <div>
                        <label class="form-label">Zástupce klienta</label>
                        <input type="text" name="revision_client_representative" value="{% if revision %}{{ revision.revision_client_representative or '' }}{% endif %}" class="form-input">
                    </div>
                </div>
            </div>

            <div>
                <h3 class="text-base font-semibold text-gray-800 mb-3 pb-2 border-b border-gray-200">Měřicí přístroj</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="form-label">Výrobce / Typ</label>
                        <input type="text" name="revision_measuring_instrument_manufacturer_type" value="{% if revision %}{{ revision.revision_measuring_instrument_manufacturer_type or '' }}{% endif %}" class="form-input">
                    </div>
                    <div>
                        <label class="form-label">Sériové číslo</label>
                        <input type="text" name="revision_measuring_instrument_serial_number" value="{% if revision %}{{ revision.revision_measuring_instrument_serial_number or '' }}{% endif %}" class="form-input">
                    </div>
                    <div>
                        <label class="form-label">Kalibrace</label>
                        <input type="text" name="revision_measuring_instrument_calibration" value="{% if revision %}{{ revision.revision_measuring_instrument_calibration or '' }}{% endif %}" class="form-input">
                    </div>
                    <div>
                        <label class="form-label">Platnost kalibrace</label>
                        <input type="date" name="revision_measuring_instrument_calibration_validity" value="{% if revision and revision.revision_measuring_instrument_calibration_validity %}{{ revision.revision_measuring_instrument_calibration_validity.strftime('%Y-%m-%d') }}{% endif %}" class="form-input">
                    </div>
                </div>
            </div>
        </div>

        <div class="px-4 py-3 bg-gray-50 border-t border-gray-200 flex justify-end space-x-2">
            <a href="/" class="btn btn-secondary">Zrušit</a>
            <button type="submit" class="btn btn-primary">
                {% if revision %}Uložit změny{% else %}Vytvořit revizi{% endif %}
            </button>
        </div>
    </form>
</div>
{% endblock %}
